<template>
  <div class="left-bar" :style="{ width: leftBarCollapse ? '80px' : '200px' }">
    <el-menu
      :default-active="defaultSelectedKeys"
      :collapse="leftBarCollapse"
      router
      :collapse-transition="false"
    >
      <template v-for="(menu, i) in menus">
        <template v-if="menu.c">
          <el-submenu :key="menu.title" :index="'' + i">
            <template #title>
              <i :class="['iconx', menu.icon]"></i>
              <span>{{ $t(`components.${menu.title}`) }}</span>
            </template>
            <template v-for="item in menu.c">
              <el-menu-item :key="item.title" :index="item.path">
                <template>{{ $t(`components.${item.title}`) }}</template>
              </el-menu-item>
            </template>
          </el-submenu>
        </template>
        <template v-else>
          <el-menu-item :key="menu.title" :index="menu.path">
            <i :class="['iconx', menu.icon]"></i>
            <span>{{ $t(`components.${menu.title}`) }}</span>
          </el-menu-item>
        </template>
      </template>
    </el-menu>
  </div>
</template>

<script>
export default {
  name: 'LeftBar',
  data() {
    return {
      menus: [],
      defaultOpenKeys: [],
    }
  },
  computed: {
    leftBarCollapse() {
      return this.$store.state.leftBarCollapse
    },
    defaultSelectedKeys() {
      const { path } = this.$route
      return `/${path.split('/')[1]}`
    },
  },
  created() {
    let dashboard = [
      {
        title: 'dashboard',
        path: '/dashboard',
      },
      {
        title: 'alarm',
        path: '/alarm',
      },
      {
        title: 'tools',
        path: '/tools',
      },
    ]

    let management = [
      {
        title: 'clients',
        path: '/clients',
      },
      {
        title: 'topics',
        path: '/topics',
      },
      {
        title: 'subscriptions',
        path: '/subscriptions',
      },
    ]

    let authentication = [
      {
        title: 'authentication',
        path: '/authentication',
      },
      // {
      //   title: 'authorization',
      //   path: '/authorization',
      // },
    ]

    let system = [
      { title: 'users', path: '/users' },
      {
        title: 'blacklist',
        path: '/blacklist',
      },
    ]

    let config = [
      {
        title: 'advanced',
        path: '/advanced',
      },
    ]

    this.menus = [
      {
        title: 'monitoring',
        icon: 'icon-monitoring',
        c: dashboard,
      },
      {
        title: 'management',
        icon: 'icon-management',
        c: management,
      },
      {
        title: 'auth',
        icon: 'icon-authentication',
        c: authentication,
      },
      // {
      //   title: 'gateway',
      //   icon: 'icon-gateway',
      //   path: '/gateway',
      // },
      {
        title: 'system',
        icon: 'icon-system',
        c: system,
      },
      {
        title: 'configuration',
        icon: 'icon-configuration',
        c: config,
      },
      // {
      //   title: 'ruleengine',
      //   icon: 'icon-guizeyinqing',
      //   path: '/ruleengine',
      // },
      // {
      //   title: 'modules',
      //   path: '/modules',
      //   icon: 'icon-changjingguanli',
      // },
      // {
      //   title: 'setting',
      //   path: '/setting',
      //   icon: 'icon-icon_shezhi',
      // },
      // {
      //   title: 'general',
      //   icon: 'icon-fenzuguanli',
      //   path: '/general',
      // },
    ]
  },
}
</script>

<style lang="scss">
.left-bar {
  margin-top: 60px;
  height: calc(100vh - 60px);
  transition: all 0.3s;

  .el-menu--collapse {
    width: 80px;

    & i {
      margin-left: 10px;
    }
  }
}
</style>
